<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/create3000/cobweb/master/stable/1/1.19/cobweb.css"/>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
      <!--script type="text/javascript" src="https://cdn.rawgit.com/create3000/cobweb/master/stable/1/1.19/cobweb.min.js"></script-->
      <script type="text/javascript" src="https://rawgit.com/create3000/cobweb/master/cobweb.js/cobweb.min.js"></script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/mode/xml/xml.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/edit/matchbrackets.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/edit/matchtags.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/fold/xml-fold.js"> </script>

   <style>
X3D {
   width: 100%;
   height: 400px;
}
   </style>
   </head>
   <body>
      <form>
         Edit and click to load:<button type='button' onclick='updatex3d();'>Update</button> Remove any initial white space.
         <textarea name="x3dcontent" id='x3dcontent' rows="30" cols="120" onchange='loadX3d("x3dele", event.target.value); console.log("changed");'></textarea>
         </form>
      <X3D id='x3dele' cache='false' url='  "gears42P.x3d"  '>
         <p>Your browser may not support all features required by Cobweb!</p>
      </X3D>
      <script>
         var editor = CodeMirror.fromTextArea(document.getElementById("x3dcontent"),
         {
            lineNumbers: true,
            mode: "xml",
            matchBrackets: true,
            matchTags: {bothTags: true}
         });
         var x3dele = document.getElementById("x3dele");
         
         /*
         editor.on("changes", function(){
            var browser = X3D.getBrowser(x3dele);
            var content = editor.getDoc().getValue(); 
            browser.replaceWorld(browser.createX3DFromString(content));
         });
         */
         
         function updatex3d() {
            var browser = X3D.getBrowser(x3dele);
            editor.save();
            var content = editor.getDoc().getValue(); 
            browser.replaceWorld(browser.createX3DFromString(content));
         }
         
         function loadX3d (id, content) {
            var x3dele = document.getElementById(id);
            var dataurl = "data:text/plain,base64;" + btoa(content);
            var browser = X3D.getBrowser(x3dele);
            browser.replaceWorld(browser.createX3DFromString(content));
         }
      </script>
   </body>
</html>
